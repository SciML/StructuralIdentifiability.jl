<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reparametrizations · StructuralIdentifiability.jl</title><meta name="title" content="Reparametrizations · StructuralIdentifiability.jl"/><meta property="og:title" content="Reparametrizations · StructuralIdentifiability.jl"/><meta property="twitter:title" content="Reparametrizations · StructuralIdentifiability.jl"/><meta name="description" content="Documentation for StructuralIdentifiability.jl."/><meta property="og:description" content="Documentation for StructuralIdentifiability.jl."/><meta property="twitter:description" content="Documentation for StructuralIdentifiability.jl."/><meta property="og:url" content="https://docs.sciml.ai/StructuralIdentifiability/stable/tutorials/reparametrization/"/><meta property="twitter:url" content="https://docs.sciml.ai/StructuralIdentifiability/stable/tutorials/reparametrization/"/><link rel="canonical" href="https://docs.sciml.ai/StructuralIdentifiability/stable/tutorials/reparametrization/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="StructuralIdentifiability.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">StructuralIdentifiability.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../creating_ode/">Creating ODE System</a></li><li><a class="tocitem" href="../identifiability/">Identifiability of Differential Models (Local and Global)</a></li><li><a class="tocitem" href="../identifiable_functions/">Globally Identifiable Functions</a></li><li><a class="tocitem" href="../discrete_time/">Identifiability of Discrete-Time Models (Local)</a></li><li class="is-active"><a class="tocitem" href>Reparametrizations</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Example:-SEUIR-model"><span>Example: SEUIR model</span></a></li></ul></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../input/input/">Parsing input system</a></li><li><a class="tocitem" href="../../identifiability/identifiability/">Functions to Assess Identifiability</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../utils/local_identifiability/">Local Identifiability Tools</a></li><li><a class="tocitem" href="../../utils/global_identifiability/">Global Identifiability Tools</a></li><li><a class="tocitem" href="../../utils/elimination/">Elimination</a></li><li><a class="tocitem" href="../../utils/ode/">ODE Tools</a></li><li><a class="tocitem" href="../../utils/power_series_utils/">Power Series Tools</a></li><li><a class="tocitem" href="../../utils/primality/">Primality Checks</a></li><li><a class="tocitem" href="../../utils/wronskian/">Wronskian Tools</a></li><li><a class="tocitem" href="../../ioequations/ioequations/">Input-Output Equation tools</a></li><li><a class="tocitem" href="../../utils/util/">Other Utilities</a></li></ul></li><li><span class="tocitem">Export</span><ul><li><a class="tocitem" href="../../export/export/">Exporting to Other Systems</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Reparametrizations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reparametrizations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/StructuralIdentifiability.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/StructuralIdentifiability.jl/blob/master/docs/src/tutorials/reparametrization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reparametrizations"><a class="docs-heading-anchor" href="#Reparametrizations">Reparametrizations</a><a id="Reparametrizations-1"></a><a class="docs-heading-anchor-permalink" href="#Reparametrizations" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Once one has found that not all parameters and/or states of the model at hand are identifiable, one natural desire is to reparametrize the model into a one with better identifiability properties. <code>StructuralIdentifiability</code> offers such a functionality via the function <code>reparametrize_global</code>. It takes as input an ODE model and produces its transformation into another model with the same input-output behaviour but with the states and parameters being globally identifiable. Note that, in general, such a transformation may not exist in the class of rational models, so sometimes the function returns an ODE not on the whole affine space but on a manifold.</p><p>More precisely, the function returns a dictionary with three keys:</p><ul><li><p><code>:new_vars</code> is a dictionary which maps the new parameters and new states into the formulas expressing them in terms of the original parameters and states;</p></li><li><p><code>:new_ode</code> is the ODE satisfied by these new states (and the expression of the output in terms of the new states);</p></li><li><p><code>:implicit_relations</code> is a list of algebraic relations between the new states and parameters. Being nonempty, this is exactly the list of equations defining the manifold, on which the new ODE model is defined. In many interesting  cases, however, this list is empty meaning that the new ODE is a standard rational ODE model.</p></li></ul><h2 id="Example:-SEUIR-model"><a class="docs-heading-anchor" href="#Example:-SEUIR-model">Example: SEUIR model</a><a id="Example:-SEUIR-model-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-SEUIR-model" title="Permalink"></a></h2><p>Consider a SEUIR epidemiological model from<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>:</p><p class="math-container">\[\begin{cases}
S(t)&#39; = -\beta \frac{(U(t) + I(t))S(t)}{N},\\
E(t)&#39; = \beta \frac{(U(t) + I(t))S(t)}{N} - \gamma E(t),\\
U(t)&#39; = (1 - \alpha) \gamma E(t) - \delta U(t),\\
I(t)&#39; = \alpha \gamma E(t) - \delta I(t),\\
R(t)&#39; = \delta(U(t) + I(t)),\\
y(t) = I(t)
\end{cases}\]</p><p>In this model <code>S</code> is, as usually, the number of susceptible people, <code>E</code> is the number of people exposed to virus but not yet infected (as in a simple SEIR model<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>), and <code>I</code> and <code>U</code> correspond to number of infected people who report the infection and who do not, respectively. We define the model but omit <code>R</code> compartment since it does not affect the output dynamics:</p><pre><code class="language-julia hljs">using StructuralIdentifiability

ode = @ODEmodel(
    S&#39;(t) = -b * (U(t) + I(t)) * S(t) / N,
    E&#39;(t) = b * (U(t) + I(t)) * S(t) / N - g * E(t),
    U&#39;(t) = (1 - a) * g * E(t) - d * U(t),
    I&#39;(t) = a * g * E(t) - d * I(t),
    y(t) = I(t)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">S&#39;(t) = (-S(t)*U(t)*b - S(t)*I(t)*b)//N
E&#39;(t) = (S(t)*U(t)*b + S(t)*I(t)*b - E(t)*N*g)//N
U&#39;(t) = -E(t)*a*g + E(t)*g - U(t)*d
I&#39;(t) = E(t)*a*g - I(t)*d
y(t) = I(t)
</code></pre><p>Majority of the states and parameters are not identifiable in this case:</p><pre><code class="language-julia hljs">assess_identifiability(ode)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">OrderedCollections.OrderedDict{Any, Symbol} with 9 entries:
  S(t) =&gt; :nonidentifiable
  E(t) =&gt; :nonidentifiable
  U(t) =&gt; :nonidentifiable
  I(t) =&gt; :globally
  N    =&gt; :nonidentifiable
  a    =&gt; :nonidentifiable
  b    =&gt; :nonidentifiable
  d    =&gt; :globally
  g    =&gt; :globally</code></pre><p>Let us attempt to reparametrize the model, and print new variables:</p><pre><code class="language-julia hljs">reparam = reparametrize_global(ode)
@assert isempty(reparam[:implicit_relations]) # checking that the result is an ODE on the whole space, not on a manifold
reparam[:new_vars]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Nemo.QQMPolyRingElem, AbstractAlgebra.Generic.FracFieldElem{Nemo.QQMPolyRingElem}} with 8 entries:
  y1(t) =&gt; y(t)
  a3    =&gt; b//(N*a)
  X1(t) =&gt; I(t)
  a2    =&gt; d
  a1    =&gt; g
  X2(t) =&gt; S(t)*a
  X3(t) =&gt; U(t)*a + I(t)*a
  X4(t) =&gt; E(t)*a</code></pre><p>In these new variables and parameters, the original ODE can be rewritten as follows:</p><pre><code class="language-julia hljs">reparam[:new_ode]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">X1&#39;(t) = -X1(t)*a2 + X4(t)*a1
X2&#39;(t) = -X2(t)*X3(t)*a3
X3&#39;(t) = -X3(t)*a2 + X4(t)*a1
X4&#39;(t) = X2(t)*X3(t)*a3 - X4(t)*a1
y1(t) = X1(t)
</code></pre><p>In order to analyze this result, let us give more interpretable names to the new variables and parameters:</p><p class="math-container">\[I := I, \; \widetilde{E} := \alpha E, \widetilde{S} := \alpha, \; \widetilde{I} := \alpha (I + U), \; \gamma := \gamma,\;\delta := \delta,\;\widetilde{\beta} := \frac{\beta}{\alpha N}\]</p><p>Then the reparametrize system becomes</p><p class="math-container">\[\begin{cases}
\widetilde{S}&#39;(t) = -\widetilde{\beta} \widetilde{S}(t) \widetilde{I}(t),\\
\widetilde{E}&#39;(t) = \widetilde{\beta} \widetilde{S}(t) \widetilde{I}(t) - \gamma \widetilde{E}(t),\\
\widetilde{I}&#39;(t) = -\delta \widetilde{I}(t) + \gamma\widetilde{E}(t),\\
I&#39;(t) = \gamma\widetilde{E}(t) - \delta I(t),\\
y(t) = I(t)
\end{cases}\]</p><p>This reparametrization not only reduces the dimension of the parameter space from 5 to 3 but reveals interesting structural properties of the model:</p><ul><li><p>The first three equations form a self-contained model which is equivalent to a simple SEIR model, so the model gets &quot;decomposed&quot;;</p></li><li><p>New variables <span>$\widetilde{S}$</span>, <span>$\widetilde{E}$</span>, <span>$\widetilde{I}$</span> are obtained from <span>$S$</span>, <span>$E$</span>, and <span>$I$</span> by scaling by <span>$\alpha$</span> which is the ratio of people who report being infected. One can interpret this as there is a part of population who would report infection and the other part who would not. Ultimately, we can model only the ones who would as this is mainly they who contribute to the output.</p></li></ul><p>Finally, we can check that the new model is indeed globally identifiable:</p><pre><code class="language-julia hljs">assess_identifiability(reparam[:new_ode])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">OrderedCollections.OrderedDict{Any, Symbol} with 7 entries:
  X1(t) =&gt; :globally
  X2(t) =&gt; :globally
  X3(t) =&gt; :globally
  X4(t) =&gt; :globally
  a1    =&gt; :globally
  a2    =&gt; :globally
  a3    =&gt; :globally</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><blockquote><p>T. Sauer, T. Berry, D. Ebeigbe, M. Norton, A. Whalen, S. Schiff, <a href="https://doi.org/10.1137/20m1353289"><em>Identifiability of infection model parameters early in an epidemic</em></a>, SIAM Journal on Control and Optimization, 2022;</p></blockquote></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../discrete_time/">« Identifiability of Discrete-Time Models (Local)</a><a class="docs-footer-nextpage" href="../../input/input/">Parsing input system »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 19 December 2024 07:10">Thursday 19 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
